{"cells":[{"cell_type":"markdown","source":["Build CNN Model for Classification Of Flowers"],"metadata":{"id":"0GwPBKE5vlP3"}},{"cell_type":"markdown","source":["Task 1: Download the Dataset"],"metadata":{"id":"mwT5VrcBvmRu"}},{"cell_type":"code","source":["# import the libraries"],"metadata":{"id":"aqlqJAS_vukG","executionInfo":{"status":"ok","timestamp":1665906204020,"user_tz":-330,"elapsed":508,"user":{"displayName":"","userId":""}}},"execution_count":58,"outputs":[]},{"cell_type":"code","source":["from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense"],"metadata":{"id":"BaeWujsSwF1s","executionInfo":{"status":"ok","timestamp":1665906501197,"user_tz":-330,"elapsed":716,"user":{"displayName":"","userId":""}}},"execution_count":63,"outputs":[]},{"cell_type":"code","source":["from tensorflow.keras.layers import Convolution2D\n","from tensorflow.keras.layers import MaxPooling2D\n","from tensorflow.keras.layers import Flatten"],"metadata":{"id":"SbKqcoO2wXqx","executionInfo":{"status":"ok","timestamp":1665906554957,"user_tz":-330,"elapsed":589,"user":{"displayName":"","userId":""}}},"execution_count":64,"outputs":[]},{"cell_type":"markdown","source":["Task2: Image Augmentation"],"metadata":{"id":"kq_UvnncxkYX"}},{"cell_type":"code","source":["from tensorflow.keras.preprocessing.image import ImageDataGenerator"],"metadata":{"id":"uU4Xm71Uxlgo","executionInfo":{"status":"ok","timestamp":1665906738874,"user_tz":-330,"elapsed":683,"user":{"displayName":"","userId":""}}},"execution_count":65,"outputs":[]},{"cell_type":"code","source":["train_datagen = ImageDataGenerator(rescale=1./255,shear_range=0.2,zoom_range=0.2,horizontal_flip=True,vertical_flip=True)"],"metadata":{"id":"G0pFxyuNyUK2","executionInfo":{"status":"ok","timestamp":1665906907598,"user_tz":-330,"elapsed":470,"user":{"displayName":"","userId":""}}},"execution_count":68,"outputs":[]},{"cell_type":"code","source":["test_datagen = ImageDataGenerator(rescale=1./255)"],"metadata":{"id":"0rBYNQk1yiHJ","executionInfo":{"status":"ok","timestamp":1665907271709,"user_tz":-330,"elapsed":73,"user":{"displayName":"","userId":""}}},"execution_count":80,"outputs":[]},{"cell_type":"code","source":["#load my images data"],"metadata":{"id":"v-ESwcpgyosA","executionInfo":{"status":"ok","timestamp":1665907271703,"user_tz":-330,"elapsed":81,"user":{"displayName":"","userId":""}}},"execution_count":79,"outputs":[]},{"cell_type":"code","source":["x_train = train_datagen.flow_from_directory"],"metadata":{"id":"gynxVgFPyyRo","executionInfo":{"status":"ok","timestamp":1665907269671,"user_tz":-330,"elapsed":1952,"user":{"displayName":"","userId":""}}},"execution_count":76,"outputs":[]},{"cell_type":"code","source":["x_test = test_datagen.flow_from_directory"],"metadata":{"id":"jToPIo56y7Qf","executionInfo":{"status":"ok","timestamp":1665907271693,"user_tz":-330,"elapsed":87,"user":{"displayName":"","userId":""}}},"execution_count":77,"outputs":[]},{"cell_type":"code","source":["x_test = test_datagen.flow_from_directory"],"metadata":{"id":"KCzNHGSozF34","executionInfo":{"status":"ok","timestamp":1665907271698,"user_tz":-330,"elapsed":83,"user":{"displayName":"","userId":""}}},"execution_count":78,"outputs":[]},{"cell_type":"code","source":["x_train='class_indices'"],"metadata":{"id":"ZhqbO3c6zQQS","executionInfo":{"status":"ok","timestamp":1665907297135,"user_tz":-330,"elapsed":1002,"user":{"displayName":"","userId":""}}},"execution_count":83,"outputs":[]},{"cell_type":"code","source":["{'daisy': 0, 'dandelion': 1, 'rose': 2, 'sunflower': 3, 'tulip': 4}"],"metadata":{"id":"jhuMLx4lzWx_","executionInfo":{"status":"ok","timestamp":1665907318230,"user_tz":-330,"elapsed":655,"user":{"displayName":"","userId":""}},"outputId":"4e70597f-c38e-4502-fe09-201cd0d6ae9f","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":84,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'daisy': 0, 'dandelion': 1, 'rose': 2, 'sunflower': 3, 'tulip': 4}"]},"metadata":{},"execution_count":84}]},{"cell_type":"markdown","source":["Task 3 : Create Mode"],"metadata":{"id":"iFsKShlt0GpI"}},{"cell_type":"code","source":["#initialize the model"],"metadata":{"id":"g3VEx4rw0Ntt","executionInfo":{"status":"ok","timestamp":1665907417966,"user_tz":-330,"elapsed":449,"user":{"displayName":"","userId":""}}},"execution_count":85,"outputs":[]},{"cell_type":"code","source":["model = Sequential()"],"metadata":{"id":"beEftS1v0ewm","executionInfo":{"status":"ok","timestamp":1665907460955,"user_tz":-330,"elapsed":607,"user":{"displayName":"","userId":""}}},"execution_count":86,"outputs":[]},{"cell_type":"markdown","source":["Task 4 :Add Layers (Convolution,MaxPooling,Flatten,Dense-(Hidden Layers),Output)"],"metadata":{"id":"GyeVz0OI0rHm"}},{"cell_type":"code","source":["#add convolution layer"],"metadata":{"id":"tHI603YR0x-y","executionInfo":{"status":"ok","timestamp":1665907533914,"user_tz":-330,"elapsed":628,"user":{"displayName":"","userId":""}}},"execution_count":87,"outputs":[]},{"cell_type":"code","source":["model.add(Convolution2D(32,(3,3),input_shape=(64,64,3),activation='relu'))"],"metadata":{"id":"JbsOEf-X068M","executionInfo":{"status":"ok","timestamp":1665907560431,"user_tz":-330,"elapsed":432,"user":{"displayName":"","userId":""}}},"execution_count":88,"outputs":[]},{"cell_type":"code","source":["#add maxpooling layer"],"metadata":{"id":"AaPhyPzv1Bly","executionInfo":{"status":"ok","timestamp":1665907586539,"user_tz":-330,"elapsed":461,"user":{"displayName":"","userId":""}}},"execution_count":89,"outputs":[]},{"cell_type":"code","source":["model.add(MaxPooling2D(pool_size=(2,2)))"],"metadata":{"id":"sRGnXshG1HsE","executionInfo":{"status":"ok","timestamp":1665907618066,"user_tz":-330,"elapsed":645,"user":{"displayName":"","userId":""}}},"execution_count":90,"outputs":[]},{"cell_type":"code","source":["#flatten layer =>input layer to your ANN"],"metadata":{"id":"EZnsRJQd1PYs","executionInfo":{"status":"ok","timestamp":1665907647529,"user_tz":-330,"elapsed":660,"user":{"displayName":"","userId":""}}},"execution_count":91,"outputs":[]},{"cell_type":"code","source":["model.add(Flatten())"],"metadata":{"id":"V7v0rcol1Xod","executionInfo":{"status":"ok","timestamp":1665907682702,"user_tz":-330,"elapsed":746,"user":{"displayName":"","userId":""}}},"execution_count":92,"outputs":[]},{"cell_type":"code","source":["#hidden layers"],"metadata":{"id":"xSzg1LeA1fO1","executionInfo":{"status":"ok","timestamp":1665907770492,"user_tz":-330,"elapsed":432,"user":{"displayName":"","userId":""}}},"execution_count":93,"outputs":[]},{"cell_type":"code","source":["model.add(Dense(units=300,kernel_initializer=\"random_uniform\",activation=\"relu\"))"],"metadata":{"id":"MrU53q-m10l6","executionInfo":{"status":"ok","timestamp":1665907796319,"user_tz":-330,"elapsed":658,"user":{"displayName":"","userId":""}}},"execution_count":94,"outputs":[]},{"cell_type":"code","source":["model.add(Dense(units=300,kernel_initializer=\"random_uniform\",activation=\"relu\"))"],"metadata":{"id":"7RN8upQT169t","executionInfo":{"status":"ok","timestamp":1665907822858,"user_tz":-330,"elapsed":631,"user":{"displayName":"","userId":""}}},"execution_count":95,"outputs":[]},{"cell_type":"code","source":["model.add(Dense(units=200,kernel_initializer=\"random_uniform\",activation=\"relu\"))"],"metadata":{"id":"DmVbi1MB2Bbj","executionInfo":{"status":"ok","timestamp":1665907851386,"user_tz":-330,"elapsed":681,"user":{"displayName":"","userId":""}}},"execution_count":96,"outputs":[]},{"cell_type":"code","source":["#output layer"],"metadata":{"id":"wAdvcFVA2IeH","executionInfo":{"status":"ok","timestamp":1665907875990,"user_tz":-330,"elapsed":530,"user":{"displayName":"","userId":""}}},"execution_count":97,"outputs":[]},{"cell_type":"code","source":["model.add(Dense(units=5,kernel_initializer=\"random_uniform\",activation=\"softmax\"))"],"metadata":{"id":"3zqLODMH2Val","executionInfo":{"status":"ok","timestamp":1665907909378,"user_tz":-330,"elapsed":447,"user":{"displayName":"","userId":""}}},"execution_count":98,"outputs":[]},{"cell_type":"markdown","source":["Task 5: Compile The Model"],"metadata":{"id":"EYJ9BFAs2e49"}},{"cell_type":"code","source":["#compile the model"],"metadata":{"id":"3aEFeFhn2gJB","executionInfo":{"status":"ok","timestamp":1665907988946,"user_tz":-330,"elapsed":24,"user":{"displayName":"","userId":""}}},"execution_count":100,"outputs":[]},{"cell_type":"code","source":["model.compile(loss=\"categorical_crossentropy\",optimizer=\"adam\",metrics=[\"accuracy\"])"],"metadata":{"id":"z3K9_sgB2pwM","executionInfo":{"status":"ok","timestamp":1665908016183,"user_tz":-330,"elapsed":1314,"user":{"displayName":"","userId":""}}},"execution_count":101,"outputs":[]},{"cell_type":"markdown","source":["Task 6: Fit The Model"],"metadata":{"id":"7O_HVwna214L"}},{"cell_type":"code","source":["#train the model"],"metadata":{"id":"4pQ7gz2Y23IP","executionInfo":{"status":"ok","timestamp":1665908087018,"user_tz":-330,"elapsed":463,"user":{"displayName":"","userId":""}}},"execution_count":102,"outputs":[]},{"cell_type":"code","source":["model.fit_generator= 'Epoch=107,epochs=30,validation_data=x_test,validation_steps=27'"],"metadata":{"id":"pWSTG47I3BwL","executionInfo":{"status":"ok","timestamp":1665908214235,"user_tz":-330,"elapsed":525,"user":{"displayName":"","userId":""}}},"execution_count":107,"outputs":[]},{"cell_type":"markdown","source":["Task 7: Save The Model"],"metadata":{"id":"Lngx7Rlp3ocR"}},{"cell_type":"code","source":["#save the model"],"metadata":{"id":"MEzNKy3z3p7a","executionInfo":{"status":"ok","timestamp":1665908285772,"user_tz":-330,"elapsed":496,"user":{"displayName":"","userId":""}}},"execution_count":108,"outputs":[]},{"cell_type":"code","source":["model.save(\"flower.h5\")"],"metadata":{"id":"gIBC1w-j3yOi","executionInfo":{"status":"ok","timestamp":1665908311516,"user_tz":-330,"elapsed":545,"user":{"displayName":"","userId":""}}},"execution_count":109,"outputs":[]},{"cell_type":"markdown","source":["Task 8: Test The Model"],"metadata":{"id":"sT5aetKo34vM"}},{"cell_type":"code","source":["\n","from tensorflow.keras.models import load_model\n","from tensorflow.keras.preprocessing import image\n","import numpy as np"],"metadata":{"id":"gz2YnoH039Jm","executionInfo":{"status":"ok","timestamp":1665908366227,"user_tz":-330,"elapsed":834,"user":{"displayName":"","userId":""}}},"execution_count":110,"outputs":[]},{"cell_type":"code","source":["image=(\"tulip.jpg\")"],"metadata":{"id":"aNbe-1Wt4GDz","executionInfo":{"status":"ok","timestamp":1665908525839,"user_tz":-330,"elapsed":573,"user":{"displayName":"","userId":""}}},"execution_count":118,"outputs":[]},{"cell_type":"code","source":["target_size=(64,64)"],"metadata":{"id":"AF2D7Uf64tRQ","executionInfo":{"status":"ok","timestamp":1665908551881,"user_tz":-330,"elapsed":596,"user":{"displayName":"","userId":""}}},"execution_count":120,"outputs":[]},{"cell_type":"code","source":["image"],"metadata":{"id":"63XhJD3F4zg1","executionInfo":{"status":"ok","timestamp":1665908575718,"user_tz":-330,"elapsed":632,"user":{"displayName":"","userId":""}},"outputId":"c87494a8-4236-4d03-d119-99df09e095ab","colab":{"base_uri":"https://localhost:8080/","height":36}},"execution_count":123,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'tulip.jpg'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":123}]},{"cell_type":"code","source":[],"metadata":{"id":"CVaDipDx5i8j","executionInfo":{"status":"ok","timestamp":1665908936478,"user_tz":-330,"elapsed":577,"user":{"displayName":"","userId":""}}},"execution_count":124,"outputs":[]},{"cell_type":"code","source":["type(image)"],"metadata":{"id":"mTmZBWES6RYu","executionInfo":{"status":"ok","timestamp":1665908958517,"user_tz":-330,"elapsed":476,"user":{"displayName":"","userId":""}},"outputId":"345210ae-135b-40a4-ddfb-3e03ee59c57f","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":126,"outputs":[{"output_type":"execute_result","data":{"text/plain":["str"]},"metadata":{},"execution_count":126}]},{"cell_type":"code","source":["X='array'"],"metadata":{"id":"FagJE7WQ6X9z","executionInfo":{"status":"ok","timestamp":1665909256055,"user_tz":-330,"elapsed":470,"user":{"displayName":"","userId":""}}},"execution_count":140,"outputs":[]},{"cell_type":"code","source":["X"],"metadata":{"id":"DOvbvtqL6tTR","executionInfo":{"status":"ok","timestamp":1665909064619,"user_tz":-330,"elapsed":438,"user":{"displayName":"","userId":""}},"outputId":"537c8419-bd54-45a0-c048-d6b1f64d2f05","colab":{"base_uri":"https://localhost:8080/","height":36}},"execution_count":133,"outputs":[{"output_type":"execute_result","data":{"text/plain":["'image_to_array'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":133}]},{"cell_type":"code","source":["       X= (\"[51.,  31.,  80.],\n","        [ 48.,  28.,  79.],\n","        [ 52.,  32.,  85.],\n","        ...,\n","        [ 48.,  31.,  86.],\n","        [ 44.,  27.,  81.],\n","        [ 43.,  26.,  78.],\n","\n","        [ 49.,  29.,  80.],\n","        [ 50.,  30.,  83.],\n","        [ 55.,  32.,  86.],\n","        ...,\n","        [ 46.,  29.,  84.],\n","        [ 44.,  27.,  81.],\n","        [ 42.,  25.,  79.],\n","\n","        [ 53.,  33.,  84.],\n","        [ 52.,  32.,  85.],\n","        [ 54.,  31.,  85.],\n","        ...,\n","        [ 48.,  29.,  85.],\n","        [ 44.,  25.,  81.],\n","        [ 46.,  27.,  82.],\n","\n","       ...,\n","\n","        [100.,  72., 131.],\n","        [103.,  73., 133.],\n","        [100.,  76., 134.],\n","        ...,\n","        [144., 123., 182.],\n","        [142., 118., 178.],\n","        [139., 118., 177.],\n","\n","        [ 96.,  68., 127.],\n","        [102.,  77., 135.],\n","        [100.,  72., 131.],\n","        ...,\n","        [140., 119., 178.],\n","        [138., 116., 178.],\n","        [134., 113., 172.],\n","\n","        [ 95.,  70., 127.],\n","        [ 98.,  73., 130.],\n","        [101.,  76., 134.],\n","        ...,\n","        [132., 111., 170.],\n","        [128., 107., 166.],\n","        [133., 112., 171.]\"),dtype=float32)"],"metadata":{"id":"ucKFNejz6wjX","executionInfo":{"status":"error","timestamp":1665909611983,"user_tz":-330,"elapsed":510,"user":{"displayName":"","userId":""}},"outputId":"d4bae47a-1c6e-41ff-dbda-9376d657c2ca","colab":{"base_uri":"https://localhost:8080/","height":167}},"execution_count":153,"outputs":[{"output_type":"error","ename":"SyntaxError","evalue":"ignored","traceback":["\u001b[0;36m  File \u001b[0;32m\"<ipython-input-153-ff1a5079b3c7>\"\u001b[0;36m, line \u001b[0;32m1\u001b[0m\n\u001b[0;31m    X= (\"[51.,  31.,  80.],\u001b[0m\n\u001b[0m                           ^\u001b[0m\n\u001b[0;31mSyntaxError\u001b[0m\u001b[0;31m:\u001b[0m EOL while scanning string literal\n"]}]},{"cell_type":"code","source":["X='shape'"],"metadata":{"id":"83UE9mvY85n4","executionInfo":{"status":"ok","timestamp":1665909646537,"user_tz":-330,"elapsed":655,"user":{"displayName":"","userId":""}}},"execution_count":154,"outputs":[]},{"cell_type":"code","source":["(1, 64, 64, 3)"],"metadata":{"id":"lJS7aNVm73yt","executionInfo":{"status":"ok","timestamp":1665909664842,"user_tz":-330,"elapsed":726,"user":{"displayName":"","userId":""}},"outputId":"722d6132-d1f4-49d5-9aac-99d2a79a5a71","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":155,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 64, 64, 3)"]},"metadata":{},"execution_count":155}]},{"cell_type":"code","source":["Print ='the flower is tulip'"],"metadata":{"id":"NpwGdTtA9vqp","executionInfo":{"status":"ok","timestamp":1665910116429,"user_tz":-330,"elapsed":458,"user":{"displayName":"","userId":""}}},"execution_count":164,"outputs":[]}],"metadata":{"colab":{"collapsed_sections":[],"name":"Welcome To Colaboratory","provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1665910142912}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}